# Mybatis自动生成

### `mybatis-generator`

* ***model类***
    ```java
    public class Order implements Serializable {
        /**
         *
         * This field was generated by MyBatis Generator.
         * This field corresponds to the database column tb_order.id
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        private String id;
    
        /**
         *
         * This field was generated by MyBatis Generator.
         * This field corresponds to the database column tb_order.user_id
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        private String userId;
    
        /**
         *
         * This field was generated by MyBatis Generator.
         * This field corresponds to the database column tb_order.order_number
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        private String orderNumber;
    
        /**
         * This field was generated by MyBatis Generator.
         * This field corresponds to the database table tb_order
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        private static final long serialVersionUID = 1L;
    
        /**
         * This method was generated by MyBatis Generator.
         * This method returns the value of the database column tb_order.id
         *
         * @return the value of tb_order.id
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        public String getId() {
            return id;
        }
          
    
        /**
         * This method was generated by MyBatis Generator.
         * This method sets the value of the database column tb_order.id
         *
         * @param id the value for tb_order.id
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        public void setId(String id) {
            this.id = id == null ? null : id.trim();
        }
    
        /**
         * This method was generated by MyBatis Generator.
         * This method returns the value of the database column tb_order.user_id
         *
         * @return the value of tb_order.user_id
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        public String getUserId() {
            return userId;
        }
          
    
        /**
         * This method was generated by MyBatis Generator.
         * This method sets the value of the database column tb_order.user_id
         *
         * @param userId the value for tb_order.user_id
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        public void setUserId(String userId) {
            this.userId = userId == null ? null : userId.trim();
        }
    
        /**
         * This method was generated by MyBatis Generator.
         * This method returns the value of the database column tb_order.order_number
         *
         * @return the value of tb_order.order_number
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        public String getOrderNumber() {
            return orderNumber;
        }
          
    
        /**
         * This method was generated by MyBatis Generator.
         * This method sets the value of the database column tb_order.order_number
         *
         * @param orderNumber the value for tb_order.order_number
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        public void setOrderNumber(String orderNumber) {
            this.orderNumber = orderNumber == null ? null : orderNumber.trim();
        }
    
        /**
         * This method was generated by MyBatis Generator.
         * This method corresponds to the database table tb_order
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        @Override
        public String toString() {
            StringBuilder sb = new StringBuilder();
            sb.append(getClass().getSimpleName());
            sb.append(" [");
            sb.append("Hash = ").append(hashCode());
            sb.append(", id=").append(id);
            sb.append(", userId=").append(userId);
            sb.append(", orderNumber=").append(orderNumber);
            sb.append("]");
            return sb.toString();
        }
    }
    ```
* ***mapper类***
    ```java
    public interface OrderMapper {
        /**
         * This method was generated by MyBatis Generator.
         * This method corresponds to the database table tb_order
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        int deleteByPrimaryKey(String id);
    
        /**
         * This method was generated by MyBatis Generator.
         * This method corresponds to the database table tb_order
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        int insert(Order record);
    
        /**
         * This method was generated by MyBatis Generator.
         * This method corresponds to the database table tb_order
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        Order selectByPrimaryKey(String id);
    
        /**
         * This method was generated by MyBatis Generator.
         * This method corresponds to the database table tb_order
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        List<Order> selectAll();
    
        /**
         * This method was generated by MyBatis Generator.
         * This method corresponds to the database table tb_order
         *
         * @mbg.generated Wed Apr 03 15:14:05 CST 2019
         */
        int updateByPrimaryKey(Order record);
    }
    ```
* ***mapper.xml文件***
    ```xml
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    <mapper namespace="com.zgl.mybatis.generator.mapper.OrderMapper">
      <resultMap id="BaseResultMap" type="com.zgl.mybatis.generator.model.Order">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed Apr 03 15:14:05 CST 2019.
        -->
        <id column="id" jdbcType="VARCHAR" property="id" />
        <result column="user_id" jdbcType="VARCHAR" property="userId" />
        <result column="order_number" jdbcType="VARCHAR" property="orderNumber" />
      </resultMap>
      <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed Apr 03 15:14:05 CST 2019.
        -->
        delete from tb_order
        where id = #{id,jdbcType=VARCHAR}
      </delete>
      <insert id="insert" parameterType="com.zgl.mybatis.generator.model.Order">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed Apr 03 15:14:05 CST 2019.
        -->
        insert into tb_order (id, user_id, order_number
          )
        values (#{id,jdbcType=VARCHAR}, #{userId,jdbcType=VARCHAR}, #{orderNumber,jdbcType=VARCHAR}
          )
      </insert>
      <update id="updateByPrimaryKey" parameterType="com.zgl.mybatis.generator.model.Order">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed Apr 03 15:14:05 CST 2019.
        -->
        update tb_order
        set user_id = #{userId,jdbcType=VARCHAR},
          order_number = #{orderNumber,jdbcType=VARCHAR}
        where id = #{id,jdbcType=VARCHAR}
      </update>
      <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed Apr 03 15:14:05 CST 2019.
        -->
        select id, user_id, order_number
        from tb_order
        where id = #{id,jdbcType=VARCHAR}
      </select>
      <select id="selectAll" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed Apr 03 15:14:05 CST 2019.
        -->
        select id, user_id, order_number
        from tb_order
      </select>
    </mapper>
    ```
### `mybatis+tkmybatis-generator`

* ***配置BaseMapper***

    ```java
    public interface BaseMapper<T> extends Mapper<T>, MySqlMapper<T> {
    }
    ```
* ***application.properties***文件进行配置
    ```
    mapper.not-empty=false
    mapper.identity=MYSQL
    mapper.mappers=com.zgl.mybatis.generator.base.BaseMapper
    ```
* ***generatorConfig.xml***配置
    ```xml
    <plugin type="tk.mybatis.mapper.generator.MapperPlugin">
    			<property name="mappers" value="com.zgl.mybatis.generator.base.BaseMapper"/>
    </plugin>
    ```
* ***通用mapper注解***
    ```java
    import tk.mybatis.spring.annotation.MapperScan;
    @SpringBootApplication
    @MapperScan("com.zgl.mybatis.generator.mapper")
    public class MybatisGeneratorApplication implements ApplicationRunner {}
    ```
* ***model类***
    ```java
    @Table(name = "tb_order")
    public class Order implements Serializable {
        @Id
        private String id;
    
        @Column(name = "user_id")
        private String userId;
    
        @Column(name = "order_number")
        private String orderNumber;
    
        private static final long serialVersionUID = 1L;
    
        /**
         * @return id
         */
        public String getId() {
            return id;
        }
    
        /**
         * @param id
         */
        public void setId(String id) {
            this.id = id;
        }
    
        /**
         * @return user_id
         */
        public String getUserId() {
            return userId;
        }
    
        /**
         * @param userId
         */
        public void setUserId(String userId) {
            this.userId = userId;
        }
    
        /**
         * @return order_number
         */
        public String getOrderNumber() {
            return orderNumber;
        }
    
        /**
         * @param orderNumber
         */
        public void setOrderNumber(String orderNumber) {
            this.orderNumber = orderNumber;
        }
    
        @Override
        public String toString() {
            StringBuilder sb = new StringBuilder();
            sb.append(getClass().getSimpleName());
            sb.append(" [");
            sb.append("Hash = ").append(hashCode());
            sb.append(", id=").append(id);
            sb.append(", userId=").append(userId);
            sb.append(", orderNumber=").append(orderNumber);
            sb.append("]");
            return sb.toString();
        }
    }
    ```
* ***mapper类***
    ```java
    public interface OrderMapper extends BaseMapper<Order> {
    }
    ```
* ***mapper.xml文件***
    ```xml
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    <mapper namespace="com.zgl.mybatis.generator.mapper.OrderMapper">
      <resultMap id="BaseResultMap" type="com.zgl.mybatis.generator.model.Order">
        <!--
          WARNING - @mbg.generated
        -->
        <id column="id" jdbcType="VARCHAR" property="id" />
        <result column="user_id" jdbcType="VARCHAR" property="userId" />
        <result column="order_number" jdbcType="VARCHAR" property="orderNumber" />
      </resultMap>
    </mapper>
    ```
### ` 生成方式`
* **指定生成model, mapper, mapper.xml文件的位置. 配置数据库的信息以及对应的表.**
* ***代码生成***
    ```java
    @SpringBootApplication
    @MapperScan("com.zgl.mybatis.generator.mapper")
    public class MybatisGeneratorApplication implements ApplicationRunner {
    
    	public static void main(String[] args) {
    		SpringApplication.run(MybatisGeneratorApplication.class, args);
    	}
    
    	@Override
    	public void run(ApplicationArguments args) throws Exception {
    		generateArtifacts();
    	}
    
    	private void generateArtifacts() throws Exception {
    		List<String> warnings = new ArrayList<>();
    		ConfigurationParser cp = new ConfigurationParser(warnings);
    		Configuration config = cp.parseConfiguration(
    				this.getClass().getResourceAsStream("/generator/autoGeneratorConfig.xml"));
    		DefaultShellCallback callback = new DefaultShellCallback(true);
    		MyBatisGenerator myBatisGenerator = new MyBatisGenerator(config, callback, warnings);
    		myBatisGenerator.generate(null);
    	}
    }
    ```
* ***generatorConfig.xml配置***
    ```xml
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE generatorConfiguration
    		PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"
    		"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd">
    
    <generatorConfiguration>
    	<context id="Mysql" targetRuntime="MyBatis3Simple" defaultModelType="flat">
    
    		<plugin type="org.mybatis.generator.plugins.ToStringPlugin"/>
    		<plugin type="org.mybatis.generator.plugins.SerializablePlugin"/>
    		<plugin type="org.mybatis.generator.plugins.RowBoundsPlugin"/>
    
    
    		<plugin type="tk.mybatis.mapper.generator.MapperPlugin">
    			<property name="mappers" value="com.zgl.mybatis.generator.base.BaseMapper"/>
    		</plugin>
    
    
    		<jdbcConnection driverClass="com.mysql.jdbc.Driver"
    		                connectionURL="jdbc:mysql://localhost:3306/ssm?characterEncoding=utf-8"
    		                userId="root"
    		                password="root">
    		</jdbcConnection>
    
    		<javaModelGenerator targetPackage="com.zgl.mybatis.generator.model"
    		                    targetProject="./src/main/java">
    		</javaModelGenerator>
    
    		<sqlMapGenerator targetPackage="com.zgl.mybatis.generator.mapper"
    		                 targetProject="./src/main/resources/mapper">
    		</sqlMapGenerator>
    
    		<javaClientGenerator targetPackage="com.zgl.mybatis.generator.mapper"
    		                     targetProject="./src/main/java"
    		                     type="XMLMAPPER">
    		</javaClientGenerator>
    
    		<table tableName="tb_user" domainObjectName="User">
    		</table>
    
    		<table schema="ssm" tableName="tb_order" domainObjectName="Order">
    		</table>
    
    		<table schema="ssm" tableName="tb_product" domainObjectName="Product">
    		</table>
    
    		<table schema="ssm" tableName="tb_order_item" domainObjectName="OrderItem">
    		</table>
    
    	</context>
    </generatorConfiguration>
    ```

  

  
